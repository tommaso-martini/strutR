<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>strutR • strutR</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="strutR">
<meta name="description" content="Struthers wetting-front model in R">
<meta property="og:description" content="Struthers wetting-front model in R">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">strutR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/vignette.html">Struthers Wetting-Front Model for Infiltration, Redistribution, and Drainage with ET (θ★ / θwp)</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tommaso-martini/strutR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="strutr--struthers-wetting-front-model-for-infiltration-redistribution-and-drainage">strutR — Struthers Wetting-Front Model for Infiltration, Redistribution, and Drainage<a class="anchor" aria-label="anchor" href="#strutr--struthers-wetting-front-model-for-infiltration-redistribution-and-drainage"></a>
</h1></div>
<p><a href="LICENSE"><img src="https://img.shields.io/badge/license-MIT-blue.svg" alt="License: MIT"></a> <a href="https://doi.org/10.5281/zenodo.xxxxxx" class="external-link"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.xxxxxx.svg" alt="DOI"></a></p>
<!-- badges: start -->

<p><a href="https://github.com/tommaso-martini/strutR/actions/workflows/pkgdown.yaml" class="external-link"><img src="https://github.com/tommaso-martini/strutR/actions/workflows/pkgdown.yaml/badge.svg" alt="pkgdown"></a></p>
<p>The <code>strutR</code> package provides a complete, transparent, and open-source R implementation of the multiple wetting-front gravitational infiltration and redistribution model originally introduced by:</p>
<p>Struthers, I., Hinz, C., &amp; Sivapalan, M. (2006). <em>A multiple wetting front gravitational infiltration and redistribution model for water balance applications.</em> Water Resources Research, 42(6), W06406. <a href="https://doi.org/10.1029/2005WR004645" class="external-link uri">https://doi.org/10.1029/2005WR004645</a></p>
<hr>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The Struthers model describes infiltration, redistribution, and drainage in a one-dimensional unsaturated soil column through the dynamics of moving wetting fronts. Each front represents a discontinuity in soil water content, moving downward as infiltration proceeds and merging when moisture contrasts become small. The model assumes gravity-driven flow between fronts, with conductivity governed by a Brooks–Corey law and water mass conserved throughout redistribution and drainage.</p>
<p>This R implementation, <code>strutR</code>, is designed for reproducibility, transparency, and compatibility with stochastic and deterministic hydrological modelling. It can be used both as a standalone infiltration–redistribution solver and as a lower boundary module coupled to surface or root-zone models (for example, a two-bucket system).</p>
<p>Main features include:</p>
<ul>
<li><p>Accurate representation of infiltration–redistribution–drainage (IRD) processes based on the Struthers et al. (2006) formulation.</p></li>
<li><p>Explicit handling of multiple fronts with dynamic merging and drainage to the water table or lower boundary.</p></li>
<li>
<p>Brooks–Corey conductivity formulation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>K</mi><mi>s</mi></msub><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>θ</mi><mo>−</mo><msub><mi>θ</mi><mi>r</mi></msub></mrow><mrow><msub><mi>θ</mi><mi>s</mi></msub><mo>−</mo><msub><mi>θ</mi><mi>r</mi></msub></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mn>1</mn><mi>/</mi><mi>β</mi></mrow></msup><mi>.</mi></mrow><annotation encoding="application/x-tex"> K(\theta) = K_s \left(\frac{\theta - \theta_r}{\theta_s - \theta_r}\right)^{1/\beta}. </annotation></semantics></math></p>
</li>
<li><p>Modular structure allowing easy coupling with evapotranspiration and root-zone models.</p></li>
<li><p>Full control over gravitational and capillary terms, numerical tolerances, and merging behaviour.</p></li>
<li><p>Vignettes and utilities for plotting infiltration profiles, tracking front depths, and computing depth-averaged soil moisture.</p></li>
</ul>
<p>This implementation aims to provide a faithful and research-ready translation of the original conceptual model, suitable for hydrological process analysis, ecohydrology, soil physics education, and stochastic soil moisture studies.</p>
<hr>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="section level3">
<h3 id="from-github">From GitHub<a class="anchor" aria-label="anchor" href="#from-github"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")  # if not already installed</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"tommaso-martini/strutR"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tommaso-martini/strutR" class="external-link">strutR</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="from-a-local-source-folder">From a local source folder<a class="anchor" aria-label="anchor" href="#from-a-local-source-folder"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_local.html" class="external-link">install_local</a></span><span class="op">(</span><span class="st">"."</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tommaso-martini/strutR" class="external-link">strutR</a></span><span class="op">)</span></span></code></pre></div>
<p>After installation, all core functions and vignettes can be accessed using <code><a href="https://tommaso-martini.github.io/strutR/reference">help(package = "strutR")</a></code>.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="quick-example">Quick Example<a class="anchor" aria-label="anchor" href="#quick-example"></a>
</h2>
<p>A minimal infiltration–redistribution–drainage (IRD) simulation using the Struthers solver:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Initial conditions</span></span>
<span><span class="va">fronts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="fl">0.10</span>, x <span class="op">=</span> <span class="fl">2.0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Parameters</span></span>
<span><span class="va">theta_r</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span><span class="va">theta_s</span> <span class="op">&lt;-</span> <span class="fl">0.45</span></span>
<span><span class="va">beta</span>    <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="fl">8</span></span>
<span><span class="va">Ks</span>      <span class="op">&lt;-</span> <span class="fl">1.0</span></span>
<span><span class="va">L</span>       <span class="op">&lt;-</span> <span class="fl">2.0</span></span>
<span><span class="va">delta</span>   <span class="op">&lt;-</span> <span class="fl">0.0</span></span>
<span><span class="va">dt</span>      <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="fl">24</span></span>
<span><span class="va">f_t</span>     <span class="op">&lt;-</span> <span class="fl">0.01</span>  <span class="co"># 10 mm/day</span></span>
<span></span>
<span><span class="co"># Run a single redistribution step</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/struthers_redistr_under.html">struthers_redistr_under</a></span><span class="op">(</span></span>
<span>  fronts <span class="op">=</span> <span class="va">fronts</span>,</span>
<span>  theta_r <span class="op">=</span> <span class="va">theta_r</span>, theta_s <span class="op">=</span> <span class="va">theta_s</span>,</span>
<span>  beta <span class="op">=</span> <span class="va">beta</span>, Ks <span class="op">=</span> <span class="va">Ks</span>,</span>
<span>  L <span class="op">=</span> <span class="va">L</span>, delta <span class="op">=</span> <span class="va">delta</span>,</span>
<span>  f_t <span class="op">=</span> <span class="va">f_t</span>,</span>
<span>  dt_sub <span class="op">=</span> <span class="va">dt</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<p>This example performs a single infiltration–redistribution step consistent with the Struthers model equations, returning updated front positions, water contents, and drainage fluxes. Multiple steps can be iterated to represent continuous wet and dry cycles.</p>
<hr>
</div>
<div class="section level2">
<h2 id="theoretical-background">Theoretical background<a class="anchor" aria-label="anchor" href="#theoretical-background"></a>
</h2>
<p>The Struthers model simplifies the Richards equation by assuming that soil moisture evolves as a sequence of sharp wetting fronts separating regions of nearly uniform water content. Infiltration creates new fronts, while redistribution gradually equalises moisture differences. The gravitational flux between adjacent layers is proportional to their hydraulic conductivity, and redistribution continues until the storage gradient vanishes or drainage occurs at the bottom boundary. Front merging ensures computational efficiency while maintaining mass balance.</p>
<p>The model can be applied to a wide range of soil textures by specifying (K_s), (_s), (_r), and () according to measured or literature-based hydraulic properties. Drainage can be parameterised by the total soil depth (L) and an effective lower boundary condition.</p>
<hr>
</div>
<div class="section level2">
<h2 id="example-scripts">Example scripts<a class="anchor" aria-label="anchor" href="#example-scripts"></a>
</h2>
<p>The package includes several <strong>fully reproducible examples</strong> under the <code>examples/</code> directory (installed together with the package).<br>
These scripts illustrate the use of the <em>Struthers multiple–wetting–front</em> model under different boundary conditions and evaporation–transpiration regimes.</p>
<table class="table">
<colgroup>
<col width="53%">
<col width="46%">
</colgroup>
<thead><tr class="header">
<th>Example file</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>drydown1.R</code></td>
<td>Basic drydown simulation (no ET) with hourly redistribution and free drainage.</td>
</tr>
<tr class="even">
<td><code>drydown2.R</code></td>
<td>Nonlinear drydown with daily evapotranspiration using the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mo>⋆</mo></msub><annotation encoding="application/x-tex">\theta_\star</annotation></semantics></math>–<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mrow><mi mathvariant="normal">w</mi><mi mathvariant="normal">p</mi></mrow></msub><annotation encoding="application/x-tex">\theta_\mathrm{wp}</annotation></semantics></math> stress formulation.</td>
</tr>
<tr class="odd">
<td><code>example1.R</code></td>
<td>Short infiltration–redistribution–drainage event with diagnostic plots.</td>
</tr>
<tr class="even">
<td><code>example2.R</code></td>
<td>Full 40-day simulation combining rainfall bursts, ET, and depth-averaged moisture diagnostics.</td>
</tr>
</tbody>
</table>
<p>To <strong>locate</strong> these example files in your local installation, use <code><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file()</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># List all example scripts available in the installed package</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>, package <span class="op">=</span> <span class="st">"strutR"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Open one in the R editor</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/file.edit.html" class="external-link">file.edit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>, <span class="st">"drydown1.R"</span>, package <span class="op">=</span> <span class="st">"strutR"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>You can also <strong>run them directly</strong> without copying them manually:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>, <span class="st">"drydown2.R"</span>, package <span class="op">=</span> <span class="st">"strutR"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Each example produces diagnostic plots and prints intermediate results,<br>
making it suitable both for research reproducibility and for teaching purposes.</p>
<hr>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>If you use this software, please cite <strong>both</strong> the original model and this R implementation:</p>
<p>Struthers, I., Hinz, C., &amp; Sivapalan, M. (2006). <em>A multiple wetting front gravitational infiltration and redistribution model for water balance applications.</em> Water Resources Research, 42(6), W06406. <a href="https://doi.org/10.1029/2005WR004645" class="external-link uri">https://doi.org/10.1029/2005WR004645</a></p>
<p>Martini, T. (2025). <em>strutR: Struthers Wetting-Front Model for Infiltration, Redistribution, and Drainage (R package).</em> Version 0.1.0. MIT License. <a href="https://doi.org/10.5281/zenodo.xxxxxx" class="external-link uri">https://doi.org/10.5281/zenodo.xxxxxx</a></p>
<hr>
</div>
<div class="section level2">
<h2 id="license-and-authorship">License and authorship<a class="anchor" aria-label="anchor" href="#license-and-authorship"></a>
</h2>
<p>Copyright (c) 2025 Tommaso Martini<br>
Department of Regional and Urban Studies and Planning (DIST), University of Turin, Italy</p>
<p>Released under the MIT License. See <a href="LICENSE">LICENSE</a> for details.</p>
<p>This software is an independent, open-source reimplementation of the Struthers model. It is <strong>not affiliated</strong> with the original authors or the American Geophysical Union (AGU), and it is distributed for research and educational purposes only.</p>
<hr>
</div>
<div class="section level2">
<h2 id="related-resources">Related resources<a class="anchor" aria-label="anchor" href="#related-resources"></a>
</h2>
<ul>
<li>Original model publication: <a href="https://doi.org/10.1029/2005WR004645" class="external-link uri">https://doi.org/10.1029/2005WR004645</a><br>
</li>
<li>GitHub repository: <a href="https://github.com/tommaso-martini/strutR" class="external-link uri">https://github.com/tommaso-martini/strutR</a><br>
</li>
<li>Example vignettes: <code>vignette("struthers-examples", package = "strutR")</code>
</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/tommaso-martini/strutR/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/tommaso-martini/strutR/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing strutR</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Tommaso Martini <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0000-0000-0000" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/tommaso-martini/strutR/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/tommaso-martini/strutR/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tommaso Martini.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
