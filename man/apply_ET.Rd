% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/et.R
\name{apply_ET}
\alias{apply_ET}
\title{ET operator on a fronts profile (single time step)}
\usage{
apply_ET(
  fronts,
  ep,
  Cv,
  dt,
  theta_star,
  theta_wp,
  theta_r,
  theta_s,
  Z_root,
  Z_evap,
  delta = 0,
  debug = FALSE,
  tol_merge = 1e-06
)
}
\arguments{
\item{fronts}{list of fronts \code{list(list(theta=..., x=...), ...)}.}

\item{ep}{numeric; potential evaporation/ET \link{m/day} for the step.}

\item{Cv}{numeric in \eqn{[0,1]}; transpiring fraction.}

\item{dt}{numeric; step duration \link{day}.}

\item{theta_star, theta_wp}{numeric; transpiration thresholds.}

\item{theta_r, theta_s}{numeric; residual and saturated water contents.}

\item{Z_root}{numeric; active root-zone depth \link{m} from \code{delta}.}

\item{Z_evap}{numeric; active bare-soil evaporation depth \link{m} from \code{delta}.}

\item{delta}{numeric; absolute top reference \link{m}.}

\item{debug}{logical; print detailed diagnostics if TRUE.}

\item{tol_merge}{numeric; merge tolerance passed to the fronts merging routine.}
}
\value{
A list with:
\item{fronts}{updated fronts list after ET.}
\item{E_t}{actual transpiration volume removed \link{m}.}
\item{E_bs}{actual bare-soil evaporation volume removed \link{m}.}
}
\description{
Applies a transpiration-evaporation partition consistent with common
ecohydrological practice: transpiration acts on a prescribed root-zone
depth with a \eqn{\theta^\star/\theta_{\mathrm{wp}}} scheme (potential phase
down to \eqn{\theta^\star}, then an exponential stress regime toward
\eqn{\theta_{\mathrm{wp}}}); bare-soil evaporation acts on a shallow
\eqn{Z_{\mathrm{evap}}} and is limited below by \eqn{\theta_r}.
}
\details{
Let the step durations be \eqn{\Delta t}, the potential demand be
\eqn{e_p} \link{m/day}, and the transpiring fraction \eqn{C_v \in [0,1]}.
The potential step demands are:
\deqn{D_t = e_p C_v \Delta t,\quad D_{bs} = e_p (1-C_v) \Delta t.}
For transpiration, the available potential removal to reach
\eqn{\bar{\theta}\to\theta^\star} is \eqn{S_\star = \max(\bar{\theta}-\theta^\star,0) Z_{\mathrm{root}}}.
The stressed contribution is \eqn{S_{\mathrm{cap}} (1 - e^{-D_{\mathrm{rem}}/S_{\mathrm{cap}}})}
with \eqn{S_{\mathrm{cap}}=(\theta^\star-\theta_{\mathrm{wp}})Z_{\mathrm{root}}}.
Both TR and EV are capped by the actually available storage above their
respective lower bounds, and water is removed top-down.
}
\examples{
prof <- list(list(theta = 0.25, x = 0.2), list(theta = 0.30, x = 0.6))
apply_ET(prof,
  ep = 4 / 1000, Cv = 0.7, dt = 1,
  theta_star = 0.20, theta_wp = 0.08,
  theta_r = 0.05, theta_s = 0.45,
  Z_root = 0.4, Z_evap = 0.03
)
}
